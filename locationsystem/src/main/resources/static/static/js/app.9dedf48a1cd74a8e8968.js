webpackJsonp([1],{0:function(t,e){},"02fI":function(t,e){},1:function(t,e){},2:function(t,e){},CkGF:function(t,e){},Czl3:function(t,e){},FzFz:function(t,e){},Hjsz:function(t,e){},I3BY:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var l=a("VU/8")({name:"App"},o,!1,function(t){a("hTu5")},null,null).exports,n=a("/ocq"),s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-header",[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""}},[a("el-menu-item",{attrs:{index:"/"}},[t._v("首页")]),t._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[t._v("采集系统")]),t._v(" "),a("el-menu-item",{attrs:{index:"collectionSysV1",disabled:""}},[t._v("version1")]),t._v(" "),a("el-menu-item",{attrs:{index:"collectionSysV2"}},[t._v("version2")])],2),t._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[t._v("定位系统")]),t._v(" "),a("el-menu-item",{attrs:{index:"locationConfigPage"}},[t._v("定位配置")]),t._v(" "),a("el-menu-item",{attrs:{index:"locationShowPage"}},[t._v("定位展示")])],2),t._v(" "),a("el-submenu",{attrs:{index:"4"}},[a("template",{attrs:{disabled:"true"},slot:"title"},[t._v("公共工具")]),t._v(" "),a("el-menu-item",{attrs:{index:"statisticsInfo"}},[t._v("统计信息")]),t._v(" "),a("el-menu-item",{attrs:{index:"simulationShowPage",disabled:""}},[t._v("生成晶格文件")])],2)],1)],1),t._v(" "),a("el-main",[a("router-view")],1),t._v(" "),a("el-footer",[t._v("\n      地铁人流监测系统\n    ")])],1)},staticRenderFns:[]};var r=a("VU/8")({name:"Home",data:function(){return{activeIndex:"1"}},methods:{}},s,!1,function(t){a("URWt")},null,null).exports,c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",[this._v("软件说明")])])}]};var d=a("VU/8")({name:"Information"},c,!1,function(t){a("I3BY")},"data-v-051208f1",null).exports,u=a("mvHQ"),p=a.n(u),h={name:"collectionStart",data:function(){return{interval:7.45,k:44,seconds:0,tableData:[]}},methods:{startCollection:function(){this.$axios.post("/collection/startCollection",this.tableData)},stopCollection:function(){var t=this,e=this;this.$axios.post("/collection/finishCollection").then(function(a){t.responseResult=p()(a.data);for(var i=0,o=e.tableData.length;i<o;i++){var l=e.tableData[i],n=JSON.parse(t.responseResult);e.tableData[i].num=n[l.id+""],console.log(e.tableData[i].num)}})}},mounted:function(){var t=this,e=document.getElementById("c"),a=new fabric.Canvas(e,{selection:!1,width:2200,height:400}),i=new fabric.Rect({top:2*this.k,fill:"rgba(255, 255, 255, 0)",width:18.3*this.k,height:2.5*this.k,stroke:"green",strokeWidth:2,selectable:!1}),o=new fabric.Rect({top:2*this.k,left:(18.3+this.interval)*this.k,fill:"rgba(255, 255, 255, 0)",width:16.5*this.k,height:2.5*this.k,stroke:"green",strokeWidth:2,selectable:!1});a.add(o),a.add(i);var l,n,s=fabric.util.createClass(fabric.Rect,{type:"GridRect",selectedGrid:!1,initialize:function(t){t||(t={}),t.selectable=!1,this.callSuper("initialize",t),this.set("label",t.label||"")},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{label:this.get("label")})},_render:function(t){this.callSuper("_render",t),t.font="10px Helvetica",t.fillStyle="#333",t.fillText(this.label,-this.width/2,-this.height/2+10)}}),r=1;for(l=0;l<17;l++)for(n=0;n<5;n++){var c=new s({left:1*l*this.k,top:.5*n*this.k+2*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:.5*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+"",selectable:!1});c.on("mouse:down",function(t){console.log("selected a gridRect...")}),a.add(c),r++}for(n=0;n<5;n++)a.add(new s({left:17*this.k,top:.5*n*this.k+2*this.k,fill:"rgba(255, 255, 255, 0)",width:1.3*this.k,height:.5*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(l=0;l<15;l++)for(n=0;n<5;n++)a.add(new s({left:1*(l+18.3+this.interval)*this.k,top:.5*n*this.k+2*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:.5*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+"",selectable:!1})),r++;for(n=0;n<5;n++)a.add(new s({left:(33.3+this.interval)*this.k,top:.5*n*this.k+2*this.k,fill:"rgba(255, 255, 255, 0)",width:1.5*this.k,height:.5*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(l=0;l<17;l++)for(n=0;n<2;n++)a.add(new s({left:1*l*this.k,top:1*n*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:17*this.k,top:1*n*this.k,fill:"rgba(255, 255, 255, 0)",width:1.3*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(l=0;l<15;l++)for(n=0;n<2;n++)a.add(new s({left:1*(l+18.3+this.interval)*this.k,top:1*n*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:(33.3+this.interval)*this.k,top:1*n*this.k,fill:"rgba(255, 255, 255, 0)",width:1.5*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(l=0;l<17;l++)for(n=0;n<2;n++)a.add(new s({left:1*l*this.k,top:1*n*this.k+4.5*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:17*this.k,top:1*n*this.k+4.5*this.k,fill:"rgba(255, 255, 255, 0)",width:1.3*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(l=0;l<15;l++)for(n=0;n<2;n++)a.add(new s({left:1*(l+18.3+this.interval)*this.k,top:1*n*this.k+4.5*this.k,fill:"rgba(255, 255, 255, 0)",width:1*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:(33.3+this.interval)*this.k,top:1*n*this.k+4.5*this.k,fill:"rgba(255, 255, 255, 0)",width:1.5*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:18.3*this.k,top:1*n*this.k,fill:"rgba(255, 255, 255, 0)",width:this.interval*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<5;n++)a.add(new s({left:18.3*this.k,top:.5*n*this.k+2*this.k,fill:"rgba(255, 255, 255, 0)",width:this.interval*this.k,height:.5*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;for(n=0;n<2;n++)a.add(new s({left:18.3*this.k,top:(n+4.5)*this.k,fill:"rgba(255, 255, 255, 0)",width:this.interval*this.k,height:1*this.k,stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:r+""})),r++;a.on("mouse:down",function(e){for(var i=a.getObjects(),o=i.length-1;o>=0;o--){var l=i[o];if(a.containsPoint(event,l)&&"GridRect"==l.__proto__.type){if(0==l.selectedGrid)l.selectedGrid=!0,l.set("fill","red"),t.tableData.push({id:l.label,xPos:(l.width/2+l.left)/t.k,yPos:(l.height/2+l.top)/t.k,num:0});else{var n;l.selectedGrid=!1,l.set("fill","rgba(255, 255, 255, 0)");for(var s=0,r=t.tableData.length;s<r;s++){var c=t.tableData[s];parseInt(c.id)==parseInt(l.label)&&(n=s)}console.log(n),t.tableData.splice(n,1)}a.renderAll()}}})}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container",staticStyle:{margin:"20px"}},[a("canvas",{attrs:{id:"c"}}),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content",staticStyle:{"vertical-align":"center","line-height":"250px","font-size":"50px"},attrs:{align:"center"}},[t._v("\n      "+t._s(t.seconds)+"\n    ")])]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"250",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"晶格编号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"xPos",label:"X坐标",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"yPos",label:"Y坐标",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"总记录数",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mac",label:"采集设备Mac"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.row.mac,callback:function(a){t.$set(e.row,"mac",a)},expression:"scope.row.mac"}})]}}])})],1)],1)]),t._v(" "),a("el-button",{attrs:{type:"primary",round:""},on:{click:t.startCollection}},[t._v("开始采集")]),t._v(" "),a("el-button",{attrs:{type:"success",round:""},on:{click:t.stopCollection}},[t._v("结束采集")])],1)},staticRenderFns:[]};var m=a("VU/8")(h,f,!1,function(t){a("FzFz")},"data-v-5b15fd46",null).exports,g=a("JkCx"),v=a.n(g),b={name:"LocationShowPage",data:function(){return{heatmapInstance:"",locTimeOutId:null,locationSwith:!1,heatmap:!1,option1:{dwt:!0,heatmap:!1},option2:{macAllowDialog:!1,macAllow:!1,colorMap:[],dialogContent:{mac:"",color:"#409EFF"}},option3:{num:0},show:{girdmap:!1},canvasParams:{width:1800,height:500,canvas:""},gridMap:{left:0,right:0,top:0,buttom:0,k:1,x:[],y:[]},locpos:[],baseUrl:"locationSys/"}},watch:{heatmap:function(t,e){this.heatmapInstance.configure({visible:t})},locpos:function(t,e){for(var a=this.canvasParams.canvas.getObjects(),i=a.length-1;i>=0;i--){var o=a[i];"circle"==o.type&&this.canvasParams.canvas.remove(o)}i=0;for(var l=e.length;i<l;i++)this.canvasParams.canvas.remove(e[i]);for(i=0,l=t.length;i<l;i++)this.canvasParams.canvas.add(t[i])},locationSwith:function(t,e){1==t?this.startLoc():this.stopLoc()}},methods:{addMacMap:function(){this.option2.macAllowDialog=!1,this.option2.colorMap.push({mac:this.option2.dialogContent.mac,color:this.option2.dialogContent.color}),this.option2.dialogContent.mac="",this.option2.dialogContent.color="#409EFF"},startLoc:function(){var t=this;this.$axios.get(t.baseUrl+"startLocation"),this.locTimeOutId=setInterval(function(){t.getLocInfo()},1e3)},getLocInfo:function(){var t=this;t.$axios.get(t.baseUrl+"getLocationInfo").then(function(e){var a=p()(e.data),i=JSON.parse(a);t.locpos.splice(0,t.locpos.length);var o=i.locationResultMap;if(0==o.length)return t.option3.num=0,void t.heatmapInstance._renderer._clear();var l=0;for(var n in o){l++;for(var s=o[n].pos.x,r=o[n].pos.y,c="red",d=!1,u=0;u<t.option2.colorMap.length;u++)t.option2.colorMap[u].mac==n&&(c=t.option2.colorMap[u].color,d=!0);1==t.option2.macAllow&&0==d||t.locpos.push(new fabric.Circle({radius:6,fill:c,left:s*t.gridMap.k-6,top:r*t.gridMap.k-6}))}if(t.option3.num=l,1==t.heatmap){var h=i.deviceDensity,f=[],m=0,g=t.gridMap.x.length,v=t.gridMap.x,b=t.gridMap.y,k=t.gridMap.k;for(u=0;u<g;u++){var w=h.deviceDensity[u];m=Math.max(m,w);var _={x:Math.floor(v[u]*k),y:Math.floor(b[u]*k),value:w};f.push(_)}a={max:m,data:f};console.log(a),t.heatmapInstance.setData(a)}else t.heatmapInstance._renderer._clear()})},stopLoc:function(){this.$axios.get(this.baseUrl+"stopLocation"),clearInterval(this.locTimeOutId),this.locTimeOutId=null},buildGridMap:function(){var t=this;t.canvasParams.canvas=new fabric.Canvas(document.getElementById("c"),{selection:!1,width:t.canvasParams.width,height:t.canvasParams.height}),this.$axios.get(t.baseUrl+"getGridMapData").then(function(e){var a=e.data;if(0!=a.gridNum){t.gridMap.top=a.y[0]-a.height[0]/2,t.gridMap.left=a.x[0]-a.width[0]/2,t.gridMap.buttom=a.y[0]+a.height[0]/2,t.gridMap.right=a.x[0]+a.width[0]/2;for(var i=1;i<a.gridNum;i++)t.gridMap.top=t.gridMap.top<a.y[i]-a.height[i]/2?t.gridMap.top:a.y[i]-a.height[i]/2,t.gridMap.left=t.gridMap.left<a.x[i]-a.width[i]/2?t.gridMap.left:a.x[i]-a.width[i]/2,t.gridMap.buttom=t.gridMap.buttom>a.y[i]+a.height[i]/2?t.gridMap.buttom:a.y[i]+a.height[i]/2,t.gridMap.right=t.gridMap.right>a.x[i]+a.width[i]/2?t.gridMap.right:a.x[i]+a.width[i]/2;t.gridMap.x=a.x,t.gridMap.y=a.y;var o=t.canvasParams.width/(t.gridMap.right-t.gridMap.left),l=t.canvasParams.height/(t.gridMap.buttom-t.gridMap.top);t.gridMap.k=o>l?l:o;var n=t.gridMap.k,s=fabric.util.createClass(fabric.Rect,{type:"GridRect",selectedGrid:!1,initialize:function(t){t||(t={}),t.selectable=!1,this.callSuper("initialize",t),this.set("label",t.label||"")},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{label:this.get("label")})},_render:function(t){this.callSuper("_render",t),t.font="10px Helvetica",t.fillStyle="#333",t.fillText(this.label,-this.width/2,-this.height/2+10)}});for(i=0;i<a.gridNum;i++){var r=(a.x[i]-a.width[i]/2)*n,c=(a.y[i]-a.height[i]/2)*n,d=a.width[i]*n,u=a.height[i]*n;t.canvasParams.canvas.add(new s({left:r,top:c,width:d,height:u,fill:"rgba(255, 255, 255, 0)",stroke:"green",strokeDashArray:[1,2],strokeWidth:1,label:i+1,selectable:!1}))}}else t.show.girdmap})}},created:function(){},mounted:function(){this.buildGridMap(),this.heatmapInstance=v.a.create({container:document.getElementById("hm"),visible:this.heatmap})}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container",staticStyle:{margin:"20px"}},[a("el-alert",{directives:[{name:"show",rawName:"v-show",value:t.show.girdmap,expression:"show.girdmap"}],attrs:{title:"未加载晶格文件配置，请先加载定位配置",type:"error",effect:"dark"}}),t._v(" "),a("el-row",[a("div",{attrs:{id:"hm"}},[a("canvas",{attrs:{id:"c"}})])]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{model:t.option1,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始定位"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.locationSwith,callback:function(e){t.locationSwith=e},expression:"locationSwith"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图表类型"}},[a("el-checkbox",{model:{value:t.option1.dwt,callback:function(e){t.$set(t.option1,"dwt",e)},expression:"option1.dwt"}},[t._v("点位图")]),t._v(" "),a("el-checkbox",{model:{value:t.heatmap,callback:function(e){t.heatmap=e},expression:"heatmap"}},[t._v("热力图")])],1)],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{model:t.option2,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"Mac标注"}},[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.option2.colorMap}},[a("el-table-column",{attrs:{label:"Mac"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!0},model:{value:e.row.mac,callback:function(a){t.$set(e.row,"mac",a)},expression:"scope.row.mac"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"颜色"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"block"},[a("el-color-picker",{model:{value:e.row.color,callback:function(a){t.$set(e.row,"color",a)},expression:"scope.row.color"}})],1)]}}])})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{on:{click:function(e){t.option2.macAllowDialog=!0}}},[t._v("添加")]),t._v(" "),a("el-button",{on:{click:function(e){t.option2.colorMap=[]}}},[t._v("清空")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"开启过滤","inactive-text":"关闭过滤"},model:{value:t.option2.macAllow,callback:function(e){t.$set(t.option2,"macAllow",e)},expression:"option2.macAllow"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{model:t.option3,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"被定位设备数"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.option3.num,callback:function(e){t.$set(t.option3,"num",e)},expression:"option3.num"}})],1)],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"添加Mac匹配",visible:t.option2.macAllowDialog,"close-on-click-modal":!1,width:"20%"},on:{"update:visible":function(e){return t.$set(t.option2,"macAllowDialog",e)}}},[a("el-form",[a("el-form-item",{attrs:{label:"Mac","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.option2.dialogContent.mac,callback:function(e){t.$set(t.option2.dialogContent,"mac",e)},expression:"option2.dialogContent.mac"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"颜色","label-width":"120px"}},[a("el-color-picker",{model:{value:t.option2.dialogContent.color,callback:function(e){t.$set(t.option2.dialogContent,"color",e)},expression:"option2.dialogContent.color"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.option2.macAllowDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addMacMap}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var w=a("VU/8")(b,k,!1,function(t){a("02fI")},"data-v-069b4aa7",null).exports,_=a("bOdI"),x=a.n(_),y={name:"LocationConfigPage",data:function(){var t;return{udpport:"",udpswitch:!1,sysgridmapName:"",gridmapName:"",frequencyRefuse:[],locaionConfig:(t={minNotNullRssNum:0,k:0,locationAlgorithmName:"",resultExpireQueueTime:0,slidingWindow:0,slidingStep:0},x()(t,"locationAlgorithmName","123"),x()(t,"nameList",["123","234"]),t),macAllow:[],macRefuse:[],apItem:{mac:"",x:0,y:0},APdialog:!1,apList:[],fingerprintName:"",sysfingerprintName:"",fileList:[],fingerprintFiles:new FormData,value:"",baseUrl:"locationSys/"}},mounted:function(){this.getLocationConfig(),this.getMessageConfig(),this.getAPConfig(),this.getFingerprintConfig(),this.getGridMapConfig(),this.getUDPState()},methods:{UDPSubmit:function(){var t=this,e=(this.udpport,this.udpswitch,new FormData);e.append("port",this.udpport),e.append("open",this.udpswitch),this.$axios.post(t.baseUrl+"submitUDPState",e).then(function(t){}).catch(function(e){t.$message.error(e)})},getUDPState:function(){var t=this;this.$axios.get(t.baseUrl+"getUDPState").then(function(e){t.udpport=e.data.port,t.udpswitch=e.data.switch})},GridmapSubmit:function(){var t=this,e=new FormData;e.append("file",this.$refs.gridUpload.$children[0].fileList[0].raw,this.$refs.gridUpload.$children[0].fileList[0].name),e.append("name",t.gridmapName),console.log(this.$refs.gridUpload.$children[0].fileList[0]);this.$axios.post(t.baseUrl+"upLoadGridMap",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log(e),t.sysgridmapName=e.data})},LocationConfigSubmit:function(){var t=this;this.$axios.post(t.baseUrl+"submitLocationConfig",t.locaionConfig).then(function(e){console.log(e),t.getLocationConfig()})},getLocationConfig:function(){var t=this;this.$axios.get(t.baseUrl+"getLocationConfig").then(function(e){console.log(e.data);var a=e.data.config;t.locaionConfig.nameList=e.data.nameList,t.locaionConfig.locationAlgorithmName=e.data.nameList[0],t.locaionConfig.minNotNullRssNum=a.minNotNullRssNum,t.locaionConfig.resultExpireQueueTime=a.resultExpireQueueTime,t.locaionConfig.slidingStep=a.slidingStep,t.locaionConfig.slidingWindow=a.slidingWindow,t.locaionConfig.k=a.k})},messageFileSuccess:function(t,e,a){this.macAllow=[],this.macRefuse=[];for(var i=t.macAllow,o=t.macRefuse,l=0;l<i.length;l++)this.macAllow.push({mac:i[l]});for(l=0;l<o.length;l++)this.macRefuse.push({mac:o[l]})},MessageConfigSubmit:function(){var t=this,e={macAllow:this.macAllow,macRefuse:this.macRefuse};this.$axios.post(t.baseUrl+"changeMessageConfig",e).then(function(e){console.log(e.data),t.getMessageConfig()})},getMessageConfig:function(){var t=this;this.$axios.get(t.baseUrl+"getMessageConfig").then(function(e){t.macAllow=[],t.macRefuse=[];for(var a=e.data.macAllow,i=e.data.macRefuse,o=0;o<a.length;o++)t.macAllow.push({mac:JSON.parse(a[o]).mac});console.log(i);for(o=0;o<i.length;o++)t.macRefuse.push({mac:JSON.parse(i[o]).mac})})},apFileSuccess:function(t,e,a){console.log(t),this.apList=[];for(var i=0;i<t.aPSize;i++)this.apList.push(t.apList[i])},APConfigSubmit:function(){var t=this;this.$axios.post(t.baseUrl+"changeAPConfig",this.apList).then(function(e){console.log(e.data),t.getAPConfig()})},getAPConfig:function(){var t=this;this.$axios.get(t.baseUrl+"getAPConfig").then(function(e){t.apList=[];for(var a=e.data,i=0;i<a.aPSize;i++)t.apList.push(a.apList[i])})},addAP:function(){this.apList.push({index:this.apList.length+1,mac:this.apItem.mac,x:parseFloat(this.apItem.x),y:parseFloat(this.apItem.y)}),this.apItem={mac:"",x:0,y:0},this.APdialog=!1},fingerprintSubmit:function(){var t=this;t.fingerprintFiles.append("name",t.fingerprintName);this.$axios.post(t.baseUrl+"upLoadFingerprintFile",this.fingerprintFiles,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log(e),t.sysfingerprintName=e.data})},getFingerprintConfig:function(){var t=this;this.$axios.get(t.baseUrl+"getFingerprintConfig").then(function(e){t.sysfingerprintName=e.data})},getGridMapConfig:function(){var t=this;this.$axios.get(t.baseUrl+"getGridMapConfig").then(function(e){t.sysgridmapName=e.data})},onchange:function(t,e){if(console.log(t),console.log(e),-1!=t.name.search("avg"))this.fingerprintFiles.append("avg",t.raw,t.name);else if(-1!=t.name.search("std"))this.fingerprintFiles.append("std",t.raw,t.name);else{console.log("错误文件"),this.$alert("请添加文件名中包含avg或者std的文件");var a=e.indexOf(t);e.splice(a,1)}},handleRemove:function(t,e){-1!=t.name.search("avg")?this.fingerprintFiles.delete("avg"):-1!=t.name.search("std")&&this.fingerprintFiles.delete("std")}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("指纹库配置")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.fingerprintSubmit}},[t._v("提交")])],1),t._v(" "),a("div",[a("el-form",{ref:"form",attrs:{"label-width":"150px"}},[a("el-form-item",{attrs:{label:"指纹库文件"}},[a("el-upload",{ref:"upload",attrs:{action:"http://localhost:8081/upLoad","on-remove":t.handleRemove,limit:2,multiple:"","auto-upload":!1,"on-change":t.onchange}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),t._v(" "),a("el-input",{attrs:{disabled:""},model:{value:t.sysfingerprintName,callback:function(e){t.sysfingerprintName=e},expression:"sysfingerprintName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"指纹库名称"}},[a("el-input",{model:{value:t.fingerprintName,callback:function(e){t.fingerprintName=e},expression:"fingerprintName"}})],1)],1)],1)])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("晶格配置")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.GridmapSubmit}},[t._v("提交")])],1),t._v(" "),a("div",[a("el-form",{ref:"form",attrs:{"label-width":"150px"}},[a("el-form-item",{attrs:{label:"晶格文件"}},[a("el-upload",{ref:"gridUpload",attrs:{action:"",limit:1,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),t._v(" "),a("el-input",{attrs:{disabled:""},model:{value:t.sysgridmapName,callback:function(e){t.sysgridmapName=e},expression:"sysgridmapName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"晶格名称"}},[a("el-input",{model:{value:t.gridmapName,callback:function(e){t.gridmapName=e},expression:"gridmapName"}})],1)],1)],1)])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("UDP服务器")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.UDPSubmit}},[t._v("提交")])],1),t._v(" "),a("div",{staticClass:"text item"},[a("el-form",{ref:"form",attrs:{"label-width":"150px"}},[a("el-form-item",{attrs:{label:"端口号"}},[a("el-input",{model:{value:t.udpport,callback:function(e){t.udpport=e},expression:"udpport"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"UDP状态"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.udpswitch,callback:function(e){t.udpswitch=e},expression:"udpswitch"}})],1)],1)],1)])],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("消息过滤配置")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.MessageConfigSubmit}},[t._v("提交")])],1),t._v(" "),a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"250",border:"",data:t.macAllow}},[a("el-table-column",{attrs:{prop:"mac",label:"白名单Mac列表"}}),t._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-button",{attrs:{type:"info",round:""}},[t._v("添加")])]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("Delete")])]}}])})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"250",border:"",data:t.macRefuse}},[a("el-table-column",{attrs:{prop:"mac",label:"黑名单Mac列表"}}),t._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-button",{attrs:{type:"info",round:""}},[t._v("添加")])]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("Delete")])]}}])})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"250",border:"",data:t.frequencyRefuse}},[a("el-table-column",{attrs:{prop:"mac",label:"频段拒绝列表"}}),t._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-button",{attrs:{type:"info",round:""}},[t._v("添加")])]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("Delete")])]}}])})],1)],1)],1),t._v(" "),a("el-upload",{ref:"messsageFileUpload",attrs:{"show-file-list":!1,action:"http://localhost:8081/api/locationSys/changeMessageConfigByFile",limit:1,"on-success":t.messageFileSuccess}},[a("el-button",{attrs:{type:"primary"}},[t._v("从文件加载")])],1)],1)])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("AP列表配置")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.APConfigSubmit}},[t._v("提交")])],1),t._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"250",border:"",data:t.apList}},[a("el-table-column",{attrs:{prop:"index",label:"AP索引值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mac",label:"MAC地址"}}),t._v(" "),a("el-table-column",{attrs:{prop:"x",label:"x坐标值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"y",label:"y坐标值"}}),t._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-button",{attrs:{type:"info",round:""},on:{click:function(e){t.APdialog=!0}}},[t._v("添加")])]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("Delete")])]}}])})],1),t._v(" "),a("el-upload",{ref:"apFileUpload",attrs:{"show-file-list":!1,action:"http://localhost:8081/api/locationSys/changeAPConfigByFile",limit:1,"on-success":t.apFileSuccess}},[a("el-button",{attrs:{type:"primary"}},[t._v("从文件加载")])],1)],1)])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("定位参数配置")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.LocationConfigSubmit}},[t._v("提交")])],1),t._v(" "),a("div",[a("el-form",{ref:"form",attrs:{"label-width":"150px",model:t.locaionConfig}},[a("el-form-item",{attrs:{label:"K"}},[a("el-input",{model:{value:t.locaionConfig.k,callback:function(e){t.$set(t.locaionConfig,"k",e)},expression:"locaionConfig.k"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"最小非Null的Rss个数"}},[a("el-input",{model:{value:t.locaionConfig.minNotNullRssNum,callback:function(e){t.$set(t.locaionConfig,"minNotNullRssNum",e)},expression:"locaionConfig.minNotNullRssNum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"滑动窗口长度"}},[a("el-input",{model:{value:t.locaionConfig.slidingWindow,callback:function(e){t.$set(t.locaionConfig,"slidingWindow",e)},expression:"locaionConfig.slidingWindow"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"滑动窗口步长"}},[a("el-input",{model:{value:t.locaionConfig.slidingStep,callback:function(e){t.$set(t.locaionConfig,"slidingStep",e)},expression:"locaionConfig.slidingStep"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"定位结果保留时长"}},[a("el-input",{model:{value:t.locaionConfig.resultExpireQueueTime,callback:function(e){t.$set(t.locaionConfig,"resultExpireQueueTime",e)},expression:"locaionConfig.resultExpireQueueTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"定位算法"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.locaionConfig.locationAlgorithmName,callback:function(e){t.$set(t.locaionConfig,"locationAlgorithmName",e)},expression:"locaionConfig.locationAlgorithmName"}},t._l(t.locaionConfig.nameList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1)],1)],1)])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"AP信息",visible:t.APdialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.APdialog=e}}},[a("el-form",{attrs:{model:t.apItem}},[a("el-form-item",{attrs:{label:"探针MAC","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.apItem.mac,callback:function(e){t.$set(t.apItem,"mac",e)},expression:"apItem.mac"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"x坐标","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.apItem.x,callback:function(e){t.$set(t.apItem,"x",e)},expression:"apItem.x"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"y坐标","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.apItem.y,callback:function(e){t.$set(t.apItem,"y",e)},expression:"apItem.y"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.APdialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addAP}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var M=a("VU/8")(y,C,!1,function(t){a("CkGF"),a("Czl3")},"data-v-653099ea",null).exports,S={name:"CollectionClient",data:function(){return{notice:"使用说明：1.输入的mac地址要求由只小写字母和数字组成。2.晶格编号和坐标填写一个就可以，系统优先使用晶格编号",start:!1,seconds:0,timer:null,info:{mac:"",devmap:[],id:"",gridMapIndex:0,gridX:"",gridY:""},selectedDev:"",canvasParams:{width:1800,height:300,canvas:""},gridMap:{left:0,right:0,top:0,buttom:0,k:1}}},mounted:function(){this.getDevMapList(),this.login()},methods:{gridmapIndexChanged:function(t){var e=this;this.$axios.get("collectionSys/getGridMapXY",{params:{index:t}}).then(function(t){var a=t.data;200==a.status?(e.info.gridX=a.refObject.x,e.info.gridY=a.refObject.y):e.$message.error(a.message)}).catch(function(t){e.$message.error(t)})},login:function(){var t=this;this.$axios.get("collectionSys/login").then(function(e){var a=e.data;if(200==a.status){var i=a.refObject;if(console.log(i),void 0!=i&&(t.info.selectedDev=i.mac,t.info.gridMapIndex=i.gridmapIndex,t.info.gridX=i.gridX,t.info.gridY=i.gridY,1==i.doing)){var o=(new Date).getTime()/1e3-i.startTime;t.start=!0,t.seconds=o.toFixed(0),t.timer=setInterval(function(){t.seconds++},1e3)}}}).catch(function(e){t.$message.error("网络连接错误"+e)})},getDevMapList:function(){var t=this;this.$axios.get("collectionSys/getDevList").then(function(e){if(200==e.data.status)for(var a=e.data.refObject,i=0;i<a.length;i++){var o=a[i].mac,l=a[i].name;t.info.devmap.push({mac:o,name:l})}else t.$alert("当前无采集任务，请联系管理员")}).catch(function(e){t.notice=e,t.$alert("与服务器链接错误。请联系管理员  "+e)})},switchChanged:function(t){var e=this;if(t){var a=new FormData;a.append("mac",e.info.selectedDev),a.append("x",e.info.gridX),a.append("y",e.info.gridY),this.$axios.post("collectionSys/registerTask",a).then(function(t){var a=t.data;200==a.status?(e.$message.success("提交成功,采集已开始"),null!=e.timer&&e.stopTimer(),e.timer=setInterval(function(){e.seconds++},1e3)):(e.start=!1,e.$message.error("错误信息："+a.message))}).catch(function(t){e.start=!1,e.$message.error("错误信息："+t)})}else{var i=new FormData;i.append("mac",e.info.selectedDev),this.$axios.post("collectionSys/completeSingle",i).then(function(t){var a=t.data;if(200==a.status){var i=a.refObject,o="共采集到2.4GHz信号数"+i.infoNum2G+"条，5GHz信号数"+i.infoNum5G+"条";e.$message.success(o),e.stopTimer()}else e.start=!0,e.$message.error(a.message)}).catch(function(t){e.start=!0,e.$message.error("网络错误，错误信息："+t)})}},stopTimer:function(){clearInterval(this.timer),this.timer=null,this.seconds=0}}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",[t._v("\n    "+t._s(t.notice)+"\n  ")]),t._v(" "),a("el-row",[a("el-form",{ref:"form",attrs:{"label-width":"80px"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[a("el-form-item",{attrs:{label:"本机Mac"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:t.start},model:{value:t.info.selectedDev,callback:function(e){t.$set(t.info,"selectedDev",e)},expression:"info.selectedDev"}},t._l(t.info.devmap,function(t){return a("el-option",{key:t.mac,attrs:{label:t.mac+"-------"+t.name,value:t.mac}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"晶格序号"}},[a("el-input",{attrs:{disabled:t.start},on:{change:t.gridmapIndexChanged},model:{value:t.info.gridMapIndex,callback:function(e){t.$set(t.info,"gridMapIndex",e)},expression:"info.gridMapIndex"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"x坐标"}},[a("el-input",{attrs:{disabled:t.start},model:{value:t.info.gridX,callback:function(e){t.$set(t.info,"gridX",e)},expression:"info.gridX"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"y坐标"}},[a("el-input",{attrs:{disabled:t.start},model:{value:t.info.gridY,callback:function(e){t.$set(t.info,"gridY",e)},expression:"info.gridY"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:t.switchChanged},model:{value:t.start,callback:function(e){t.start=e},expression:"start"}})],1)],1)],1),t._v(" "),a("el-row",[a("h1",{attrs:{align:"center"}},[t._v("\n        "+t._s(t.seconds)+"秒\n      ")])])],1)},staticRenderFns:[]};var D=a("VU/8")(S,$,!1,function(t){a("nucj")},"data-v-fd994098",null).exports,N={name:"CollectionConfig",data:function(){return{baseUrl:"collectionSys/",resultData:[],form:{gridmapName:"",apName:"",dev:{mac:"",name:""},tableData:[],innerNum:0,doing:!1},timer:null}},mounted:function(){this.recoverTask()},methods:{recoverTask:function(){var t=this;this.$axios.get(this.baseUrl+"recoverTask").then(function(e){var a=e.data;if(200==a.status){var i=a.refObject.devMap,o=a.refObject.config.inZoomNum;for(var l in console.log(i),i)t.form.tableData.push({mac:l,name:i[l].name});console.log(o),t.form.innerNum=o,t.getTaskList(),t.form.doing=!0}}).catch(function(e){t.$message.error(e)})},onFinish:function(){this.$axios({url:this.baseUrl+"finishAllTask",method:"get",responseType:"blob"}).then(function(t){var e=t.data,a=new FileReader;a.readAsDataURL(e),a.onload=function(t){var e=document.createElement("a");e.download="采集结果.zip",e.href=t.target.result,document.body.appendChild(e),e.click(),document.body.removeChild(e)}}),this.stopGetTaskList(),this.form.doing=!1},indexMethod:function(t){return t+1},lookInfo:function(t){this.$message.info(t)},transMac:function(t){var e="";t=t.toLowerCase();for(var a=0;a<t.length;a++)if(t[a]>="0"&&t[a]<="9")e+=t[a];else{if(!(t[a]>="a"&&t[a]<="z")){if(":"==t[a]||"-"==t[a])continue;return""}e+=t[a]}return 12!=e.length?"":e},addDev:function(){var t=this.transMac(this.form.dev.mac);""!=t?(this.form.tableData.push({mac:t,name:this.form.dev.name}),this.form.dev.mac="",this.form.dev.name=""):this.$message.error("输入的mac地址有误")},deleteRow:function(t,e){e.splice(t,1)},onSubmit:function(){var t=this,e=new FormData;e.append("gridmapFile",this.$refs.gridmap.$children[0].fileList[0].raw,this.$refs.gridmap.$children[0].fileList[0].name),e.append("apListFile",this.$refs.aplist.$children[0].fileList[0].raw,this.$refs.aplist.$children[0].fileList[0].name);for(var a=[],i=0;i<this.form.tableData.length;i++)a.push({mac:this.form.tableData[i].mac,name:this.form.tableData[i].name});e.append("devMapList",p()(a)),e.append("innerNum",this.form.innerNum);this.$axios.post("collectionSys/submitNewTask",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.$alert(e.data),t.getTaskList(),t.form.doing=!0}).catch(function(e){t.$alert(successReslut.data)})},onGridMapchange:function(t,e){for(;e.length>1;)e.shift();this.form.gridmapName=t.name},onAPchange:function(t,e){for(;e.length>1;)e.shift();this.form.apName=t.name},getTaskList:function(){var t=this;null!=t.timer&&clearInterval(t.timer),t.timer=setInterval(function(){t.$axios.get("collectionSys/getTaskList").then(function(e){var a=e.data,i=(a.doing,a.done),o=a.devMap;t.resultData=[];for(var l=0;l<i.length;l++){var n=i[l];t.resultData.push({name:o[n.mac].name,mac:n.mac,"24G":n.result.infoNum2G,"58G":n.result.infoNum5G,startTime:n.startTime,endTime:n.endTime,durSec:n.endTime-n.startTime,status:"已完成",gridMapIndex:n.gridmapIndex})}}).catch(function(e){t.$message.error(e)})},1e3)},getSummaries:function(t){var e=t.columns,a=t.data,i=[];return e.forEach(function(t,e){if(0!=e){if("24G"==t.property||"58G"==t.property){var o=a.map(function(e){return Number(e[t.property])});i[e]=o.reduce(function(t,e){var a=Number(e);return isNaN(a)?t:t+e},0)}}else i[e]="总数"}),i},stopGetTaskList:function(){null!=this.timer&&clearInterval(this.timer),this.timer=null}}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"taskForm"},[a("h2",[t._v("创建任务")]),t._v(" "),a("el-form",{ref:"form",staticClass:"myForm",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"晶格文件"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.gridmapName,callback:function(e){t.$set(t.form,"gridmapName",e)},expression:"form.gridmapName"}},[a("template",{slot:"append"},[a("el-upload",{ref:"gridmap",attrs:{action:"","auto-upload":!1,"on-change":t.onGridMapchange,"show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.form.doing},slot:"trigger"},[t._v("选取文件")])],1)],1)],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"探针列表"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.apName,callback:function(e){t.$set(t.form,"apName",e)},expression:"form.apName"}},[a("template",{slot:"append"},[a("el-upload",{ref:"aplist",attrs:{action:"","auto-upload":!1,"on-change":t.onAPchange,"show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.form.doing},slot:"trigger"},[t._v("选取文件")])],1)],1)],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"设备列表"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.dev.mac,callback:function(e){t.$set(t.form.dev,"mac",e)},expression:"form.dev.mac"}},[a("template",{slot:"prepend"},[t._v("mac地址")])],2)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.dev.name,callback:function(e){t.$set(t.form.dev,"name",e)},expression:"form.dev.name"}},[a("template",{slot:"prepend"},[t._v("设备名")])],2)],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{disabled:t.form.doing},on:{click:t.addDev}},[t._v("添加")])],1)],1),t._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.tableData,"max-height":"250"}},[a("el-table-column",{attrs:{prop:"mac",label:"MAC地址",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"别称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.deleteRow(e.$index,t.form.tableData)}}},[t._v("\n                        移除\n                      ")])]}}])})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"内晶格数"}},[a("el-input",{attrs:{placeholder:"请输入内容",disabled:t.form.doing},model:{value:t.form.innerNum,callback:function(e){t.$set(t.form,"innerNum",e)},expression:"form.innerNum"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:t.form.doing},on:{click:t.onSubmit}},[t._v("立即创建")]),t._v(" "),a("el-button",{attrs:{type:"success",disabled:!t.form.doing},on:{click:t.onFinish}},[t._v("停止任务")])],1)],1)],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"taskForm"},[a("h2",[t._v("采集详情")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.resultData,border:"","summary-method":t.getSummaries,"show-summary":"","max-height":"500px"}},[a("el-table-column",{attrs:{type:"index",index:t.indexMethod}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"设备名",sortable:"",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mac",sortable:"",label:"Mac"}}),t._v(" "),a("el-table-column",{attrs:{prop:"24G",sortable:"",label:"2.4G"}}),t._v(" "),a("el-table-column",{attrs:{prop:"58G",sortable:"",label:"5.8G"}}),t._v(" "),a("el-table-column",{attrs:{prop:"gridMapIndex",sortable:"",label:"采集晶格"}}),t._v(" "),a("el-table-column",{attrs:{prop:"durSec",sortable:"",label:"持续秒数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",sortable:"",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"startTime",sortable:"",label:"开始时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"endTime",sortable:"",label:"结束时间"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.lookInfo(e.row)}}},[t._v("详情")])]}}])})],1)],1)])],1)],1)},staticRenderFns:[]};var I=a("VU/8")(N,A,!1,function(t){a("zWMZ")},"data-v-7d1f8187",null).exports,L=a("BO1k"),P=a.n(L),F=a("c/Tr"),T=a.n(F),R=a("lHA8"),U=a.n(R),G=(a("Gu7T"),{name:"StatisticsInfo",data:function(){return{displayInfo:[],frequency:[],sec:1,start:!1,tid:null,watchMac:[],watchMacTableData:{}}},methods:{goBack:function(){console.log("back...")},removeWatchMac:function(t){var e=this.watchMac.indexOf(t);this.watchMac.splice(e,1)},confirmWatch:function(){var t=this,e=this;this.$prompt("请输入设备Mac","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value;e.watchMac.push(a)}).catch(function(e){t.$message({type:"info",message:"取消输入"+e})})},startStatistics:function(){this.start=!0;var t=parseInt(this.sec);this.$axios.get("startStatistics",{params:{t:t}}).catch(function(t){alert(t)}),this.getInfo(t)},getInfo:function(t){var e=this;null!=e.tid&&clearInterval(e.tid),e.tid=setInterval(function(){e.$axios.post("getStatisticsInfo",e.watchMac).then(function(t){var a=t.data.all;e.displayInfo.splice(0,e.displayInfo.length);var i=new U.a;for(var o in a){var l=a[o].frequencyNum;for(var n in l)n=parseInt(n),i.add(n)}for(var o in(i=T()(i)).sort(function(t,e){return t-e}),a){var s=(y=a[o]).dataNum,r=(y.devMap,l=y.frequencyNum,{apMac:o,dataNum:s,rssNum:y.rssNum,uniqueDevMacNum:y.uniqueDevMacNum,rssMap:l}),c=!0,d=!1,u=void 0;try{for(var p,h=P()(i.values());!(c=(p=h.next()).done);c=!0){var f=p.value;void 0==l[f]||null==l[f]?r[f]=0:r[f]=l[f]}}catch(t){d=!0,u=t}finally{try{!c&&h.return&&h.return()}finally{if(d)throw u}}e.displayInfo.push(r)}e.frequency.splice(0,e.frequency.length);var m=!0,g=!1,v=void 0;try{for(var b,k=P()(i.values());!(m=(b=k.next()).done);m=!0){var w=b.value;e.frequency.push({label:w+"",prop:w+""})}}catch(t){g=!0,v=t}finally{try{!m&&k.return&&k.return()}finally{if(g)throw v}}console.log(e.watchMac);for(var _=0;_<e.watchMac.length;_++){var x=e.watchMac[_];console.log(x);var y=t.data[x];if(console.log(y),void 0!=y&&null!=y){var C=[],M=y.rssAvgMap;for(var S in M){var $=M[S];C.push({apMac:S,rss:$.rssi[0].toFixed(2)})}var D=[],N=y.messages;for(_=0;_<N.length;_++){var A=N[_],I=new Date(A.timestamp);D.push({apMac:A.apMac,frequency:A.frequency,rssi:A.rssi.toFixed(2),timestamp:I.getHours()+":"+I.getMinutes()+":"+I.getSeconds()})}e.watchMacTableData[x]={rssAvgMap:C,messages:D},console.log(e.watchMacTableData)}}}).catch(function(t){e.$message.error(t)})},1e3*t)},stopStatistics:function(){this.tid&&clearInterval(this.tid),this.$axios.get("stopStatistics").catch(function(t){alert(t)}),this.start=!1}},beforeDestroy:function(){this.stopStatistics()}}),W={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-page-header",{attrs:{content:"统计详情"},on:{back:t.goBack}}),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"",disabled:t.start},model:{value:t.sec,callback:function(e){t.sec=e},expression:"sec"}})],1),t._v(" "),a("el-form-item",[a("el-button",{on:{click:t.startStatistics}},[t._v("开始")]),t._v(" "),a("el-button",{on:{click:t.stopStatistics}},[t._v("结束")])],1)],1),t._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.displayInfo,"max-height":"400px"}},[a("el-table-column",{attrs:{prop:"apMac",label:"AP Mac",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"基础信息"}},[a("el-table-column",{attrs:{prop:"dataNum",label:"数据包数",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rssNum",label:"有效信息数",width:"100"}})],1),t._v(" "),a("el-table-column",{attrs:{label:"信道号统计"}},[t._l(t.frequency,function(t){return[a("el-table-column",{attrs:{label:t.label,prop:t.prop,width:"80"}})]})],2)],1)],1),t._v(" "),a("div",[a("el-button",{on:{click:t.confirmWatch}},[t._v("添加监控")]),t._v(" "),a("div",[a("el-row",{attrs:{gutter:10}},[t._l(t.watchMac,function(e){return[a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"always"}},[a("div",[a("h3",[t._v(t._s(e))])]),t._v(" "),a("div",[a("el-row",{attrs:{gutter:60}},[a("el-col",{attrs:{span:6}},[void 0!=t.watchMacTableData[e]?[a("h3",[t._v("均值信息")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.watchMacTableData[e].rssAvgMap}},[a("el-table-column",{attrs:{prop:"apMac",label:"AP-Mac",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rss",label:"Rss值",width:"80"}})],1)]:t._e()],2),t._v(" "),a("el-col",{attrs:{span:12,offset:6}},[void 0!=t.watchMacTableData[e]?[a("h3",[t._v("被嗅探到的记录 "),a("span",[t._v(t._s(t.watchMacTableData[e].messages.length)+" 条")])]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.watchMacTableData[e].messages,"max-height":"300"}},[a("el-table-column",{attrs:{prop:"apMac",label:"AP-Mac",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"frequency",label:"信道号",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rssi",label:"rss值",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"timestamp",label:"探测时间",width:"150"}})],1)]:t._e()],2)],1),t._v(" "),a("div",[a("el-button",{on:{click:function(a){return t.removeWatchMac(e)}}},[t._v("删除")])],1)],1)])],1)]})],2)],1)],1)],1)},staticRenderFns:[]};var z=a("VU/8")(G,W,!1,function(t){a("Hjsz")},"data-v-76c9b63c",null).exports;i.default.use(n.a);var O=new n.a({routes:[{mode:"history",path:"/",name:"Home",component:r,children:[{path:"/",component:d},{path:"/collectionSysV1",component:m},{path:"/locationShowPage",component:w},{path:"/locationConfigPage",component:M},{path:"/collectionSysV2",component:I},{path:"/statisticsInfo",component:z}]},{path:"/c",name:"CollectionClient",component:D}]}),E=a("zL8q"),j=a.n(E),q=(a("tvR6"),a("tsU9"),a("gAs1"),a("mtWM")),H=window.location.protocol,V=window.location.host.split(":")[0];console.log(H+"//"+V+":8081"),q.defaults.baseURL=H+"//"+V+":8081/api",q.defaults.withCredentials=!0,q.defaults.changeOrigin=!0,i.default.prototype.$axios=q,i.default.use(j.a),new i.default({el:"#app",render:function(t){return t(l)},router:O})},URWt:function(t,e){},hTu5:function(t,e){},nucj:function(t,e){},tvR6:function(t,e){},zWMZ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.9dedf48a1cd74a8e8968.js.map